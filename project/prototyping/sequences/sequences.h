#include <linux/binfmts.h>
#include <linux/fs.h>
#include <linux/sched.h>

#define SEQUENCE_LENGTH 10

struct sequence_t {
    u16 value[SEQUENCE_LENGTH];
};

enum lsm_id_t {
    LSM_BPRM_CHECK_SECURITY = 1,
    LSM_TASK_ALLOC,
    LSM_TASK_FREE,
    LSM_TASK_SETPGID,
    LSM_TASK_GETPGID,
    LSM_TASK_GETSID,
    LSM_TASK_SETNICE,
    LSM_TASK_SETIOPRIO,
    LSM_TASK_GETIOPRIO,
    LSM_TASK_PRLIMIT,
    LSM_TASK_SETRLIMIT,
    LSM_TASK_SETSCHEDULER,
    LSM_TASK_GETSCHEDULER,
    LSM_TASK_MOVEMEMORY,
    LSM_TASK_KILL,  // TODO: split this into coarse signal categories
    LSM_TASK_PRCTL,
    LSM_SB_STATFS,
    LSM_SB_MOUNT,
    LSM_SB_REMOUNT,
    LSM_SB_UMOUNT,
    LSM_SB_PIVOTROOT,
    LSM_MOVE_MOUNT,
    LSM_INODE_CREATE,
    LSM_INODE_LINK,
    LSM_INODE_SYMLINK,
    LSM_INODE_MKDIR,
    LSM_INODE_RMDIR,
    LSM_INODE_MKNOD,
    LSM_INODE_RENAME,
    LSM_INODE_READLINK,
    LSM_INODE_FOLLOW_LINK,
    LSM_INODE_PERMISSION,  // TODO: split this into READ, WRITE, APPEND, EXEC
    LSM_INODE_SETATTR,
    LSM_INODE_GETATTR,
    LSM_INODE_SETXATTR,
    LSM_INODE_GETXATTR,
    LSM_INODE_LISTXATTR,
    LSM_INODE_REMOVEXATTR,
    LSM_FILE_PERMISSION,  // TODO: split this into READ, WRITE, APPEND, EXEC
    LSM_FILE_IOCTL,
    LSM_MMAP_ADDR,
    LSM_MMAP_FILE,
    LSM_FILE_MPROTECT,
    LSM_FILE_LOCK,
    LSM_FILE_FCNTL,
    LSM_FILE_SEND_SIGIOTASK,
    LSM_FILE_RECEIVE,
    LSM_UNIX_STREAM_CONNECT,
    LSM_UNIX_MAY_SEND,
    LSM_SOCKET_CREATE,
    LSM_SOCKET_SOCKETPAIR,
    LSM_SOCKET_BIND,
    LSM_SOCKET_CONNECT,
    LSM_SOCKET_LISTEN,
    LSM_SOCKET_ACCEPT,
    LSM_SOCKET_SENDMSG,
    LSM_SOCKET_RECVMSG,
    LSM_SOCKET_GETSOCKNAME,
    LSM_SOCKET_GETPEERNAME,
    LSM_SOCKET_GETSOCKOPT,
    LSM_SOCKET_SETSOCKOPT,
    LSM_SOCKET_SHUTDOWN,
    LSM_TUN_DEV_CREATE,
    LSM_TUN_DEV_ATTACH,
    LSM_KEY_ALLOC,
    LSM_KEY_FREE,
    LSM_KEY_PERMISSION,  // TODO: maybe split this into operations
    LSM_IPC_PERMISSION,
    LSM_MSG_QUEUE_ASSOCIATE,
    LSM_MSG_QUEUE_MSGCTL,
    LSM_MSG_QUEUE_MSGSND,
    LSM_MSG_QUEUE_MSGRCV,
    LSM_SHM_ASSOCIATE,
    LSM_SHM_SHMCTL,
    LSM_SHM_SHMAT,
    LSM_PTRACE_ACCESS_CHECK,
    LSM_PTRACE_TRACEME,
    LSM_CAPGET,
    LSM_CAPSET,
    LSM_CAPABLE,
    LSM_QUOTACTL,
    LSM_QUOTA_ON,
    LSM_SYSLOG,
    LSM_SETTIME,
    LSM_VM_ENOUGH_MEMORY,
    LSM_BPF,
    LSM_BPF_MAP,
    LSM_BPF_PROG,
    LSM_PERF_EVENT_OPEN,
    LSM_MAX,  // This must always be the last entry
};
